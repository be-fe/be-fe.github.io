<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Chrome的First Paint | 百度EUX </title>
    <link rel="stylesheet" href="/style.css">
    <script>
      (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?d232748d06c1fe09a6db3db0077669b7";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();

      var _vds = _vds || [];
      window._vds = _vds;
      (function () {
        _vds.push(['setAccountId', '66707fb8b27442d5b3ccca57a56800fa']);
        _vds.push(['trackBot', false]);

        (function () {
          var vds = document.createElement('script');
          vds.type = 'text/javascript';
          vds.async = true;
          vds.src = '//dn-growing.qbox.me/vds.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(vds, s);
        })();
      })();
    </script>
</head>
<body>
<div id="root">
    <div class="main" data-reactroot="" data-reactid="1" data-react-checksum="418526013"><!-- react-empty: 2 --><header class="eux-header clearfix" data-reactid="3"><div class="eux-header-top" data-reactid="4"><a href="javascript:void(0);" class="eux-portable-menu" data-reactid="5"><span data-reactid="6"></span><span data-reactid="7"></span><span data-reactid="8"></span></a><!-- react-empty: 9 --><nav class="menu-primary-container" data-reactid="10"><ul id="menu-primary" class="menu" data-reactid="11"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25" data-reactid="12"><a href="/" data-reactid="13">HOME</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom current-menu-ancestor current-menu-parent menu-item-has-children menu-item-45" data-reactid="14"><a href="/" data-reactid="15">BLOG</a><ul class="sub-menu" data-reactid="16"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="17"><a href="/ue" data-reactid="18">交互</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="19"><a href="/ui" data-reactid="20">视觉</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="21"><a href="/fe" data-reactid="22">前端</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="23"><a href="/team" data-reactid="24">团队</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-46" data-reactid="25"><a href="/tools" data-reactid="26">TOOLS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-112" data-reactid="27"><a href="/works" data-reactid="28">WORKS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-138" data-reactid="29"><a href="/jobs" data-reactid="30">JOBS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50" data-reactid="31"><a href="/about-us" data-reactid="32">ABOUT US</a></li></ul></nav></div></header><div class="eux-singular clearfix" data-reactid="33"><div class="container-singular clearfix" data-reactid="34"><nav class="menu-categories-container" data-reactid="35"><ul id="menu-categories" class="menu" data-reactid="36"><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="37"><span data-reactid="38"><a href="/" data-reactid="39">全部</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="40"><span data-reactid="41"><a href="/ue" data-reactid="42">交互</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="43"><span data-reactid="44"><a href="/ui" data-reactid="45">视觉</a></span></li><li class="current-menu-item menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="46"><span data-reactid="47"><a href="/fe" data-reactid="48">前端</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="49"><span data-reactid="50"><a href="/team" data-reactid="51">团队</a></span></li></ul></nav><div class="inner clearfix" data-reactid="52"><div class="article-meta" data-reactid="53"><h1 class="title" data-reactid="54">Chrome的First Paint</h1><div class="eux-page-detail" data-reactid="55"><span data-reactid="56"><em data-reactid="57">by.</em><!-- react-text: 58 -->洪闰辉<!-- /react-text --></span><span data-reactid="59">2018-4-15</span></div></div><article data-reactid="60"><h2 id="前言" data-reactid="61"><a href="#%E5%89%8D%E8%A8%80" aria-hidden="true" data-reactid="62"><span class="icon icon-link" data-reactid="63"></span></a><!-- react-text: 64 -->前言<!-- /react-text --></h2><blockquote data-reactid="65"><p data-reactid="66">First paint 直译过来的意思就是浏览器第一次渲染(paint)，在First paint之前是白屏，在这个时间点之后用户就能看到（部分）页面内容。</p></blockquote><p data-reactid="67">所以研究这个First Paint的触发时机对于优化浏览器页面的首屏渲染时间有很重要的作用。</p><p data-reactid="68">在正题开始之前，先说下浏览器的页面的加载流程（大体过程是这样，并不精确，只是为了帮助理解后面内容）：</p><ol data-reactid="69"><li data-reactid="70">浏览器输入url，浏览器发送请求到服务器，服务器将请求的HTML返回给浏览器。</li><li data-reactid="71">浏览器下载完成HTML(Finish Loading HTML)之后，便开始从上到下解析。</li><li data-reactid="72"><p data-reactid="73">解析的过程中碰到css和js外链（其实HTML的下载也是这个流程）都会执行以下过程：</p><ol data-reactid="74"><li data-reactid="75"><strong data-reactid="76"><code data-reactid="77">Send Request</code><!-- react-text: 78 -->:表示给这个外链对应的服务器发送请求<!-- /react-text --></strong></li><li data-reactid="79"><strong data-reactid="80"><code data-reactid="81">Receive Response</code><!-- react-text: 82 -->: 表示接收响应，这里是表示告诉浏览器可以开始从网络接收数据了<!-- /react-text --></strong></li><li data-reactid="83"><strong data-reactid="84"><code data-reactid="85">Receive Data</code><!-- react-text: 86 -->:表示开始接收数据<!-- /react-text --></strong></li><li data-reactid="87"><strong data-reactid="88"><code data-reactid="89">Finish Loading</code><!-- react-text: 90 -->: 表示已经完成下载数据。<!-- /react-text --></strong></li><li data-reactid="91"><strong data-reactid="92"><code data-reactid="93">Parse Stylesheet/Evaluate</code><!-- react-text: 94 -->（默认情况下js下载完成之后执行<!-- /react-text --><code data-reactid="95">Evaluate</code><!-- react-text: 96 -->，css下载完成后会进行<!-- /react-text --><code data-reactid="97">Parse Stylesheet</code><!-- react-text: 98 -->）<!-- /react-text --></strong></li></ol></li><li data-reactid="99"><!-- react-text: 100 -->所有的css下载完成后<!-- /react-text --><code data-reactid="101">Parse Stylesheet</code><!-- react-text: 102 -->然后开始构建CSSOM<!-- /react-text --></li><li data-reactid="103"><!-- react-text: 104 -->DOM（文档对象模型）和 CSSOM（CSS对象模型）会合并生成一个渲染树(<!-- /react-text --><code data-reactid="105">Render Tree</code><!-- react-text: 106 -->)<!-- /react-text --></li><li data-reactid="107"><!-- react-text: 108 -->根据渲染树的内容计算处各个节点在网页中的大小和位置（<!-- /react-text --><code data-reactid="109">Layout</code><!-- react-text: 110 -->，可以理解为“刻章”）<!-- /react-text --></li><li data-reactid="111"><!-- react-text: 112 -->根据Layout绘制内容在浏览器上（<!-- /react-text --><code data-reactid="113">Paint</code><!-- react-text: 114 -->，可以理解为“盖章”）。<!-- /react-text --></li></ol><p data-reactid="115"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-1.jpg" data-reactid="116"/></p><h2 id="正题开始" data-reactid="117"><a href="#%E6%AD%A3%E9%A2%98%E5%BC%80%E5%A7%8B" aria-hidden="true" data-reactid="118"><span class="icon icon-link" data-reactid="119"></span></a><!-- react-text: 120 -->正题开始<!-- /react-text --></h2><p data-reactid="121"><!-- react-text: 122 -->在最新版的Chrome的<!-- /react-text --><code data-reactid="123">perfomance</code><!-- react-text: 124 -->中是能直接看到First Paint这个时间点的，为了方便大家测试，我就直接拿谷歌这个示例页面来做演示:<!-- /react-text --></p><p data-reactid="125"><a href="https://googlesamples.github.io/web-fundamentals/fundamentals/performance/critical-rendering-path/measure_crp_timing.html" data-reactid="126">测试页面</a></p><p data-reactid="127"><!-- react-text: 128 -->用chrome打开上面链接，最好是隐身模式，防止插件乱入影响判断，按F12或者右键检查元素打开控制台先切换到<!-- /react-text --><code data-reactid="129">Network</code><!-- react-text: 130 -->选项,勾选禁用缓存(缓存也会影响到判断)：<!-- /react-text --></p><p data-reactid="131"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F1.png" alt="1" data-reactid="132"/></p><p data-reactid="133"><!-- react-text: 134 -->切换到<!-- /react-text --><code data-reactid="135">Perfomance</code><!-- react-text: 136 -->，勾选<!-- /react-text --><code data-reactid="137">Screenshots</code><!-- react-text: 138 -->并点击红框进行页面分析（会自动停止的，不用点stop）：<!-- /react-text --></p><p data-reactid="139"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-2.jpg" data-reactid="140"/></p><p data-reactid="141">分析完后可以看到如下结果：</p><p data-reactid="142"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2.png" data-reactid="143"/></p><p data-reactid="144"><!-- react-text: 145 -->上图中的绿色的线就是当前页面第一次出现内容的时间点，可以将鼠标放到<!-- /react-text --><code data-reactid="146">Main</code><!-- react-text: 147 -->上面的<!-- /react-text --><code data-reactid="148">Network</code><!-- react-text: 149 -->中绿色的线附近可以看到在他之前页面空白，在他之后就有内容。 除了绿色的线还有蓝色以及红色的线，这里也解释一下：<!-- /react-text --></p><p data-reactid="150"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-4.jpg" data-reactid="151"/></p><p data-reactid="152"><!-- react-text: 153 -->简单讲一下<!-- /react-text --><code data-reactid="154">DOMContentLoaded</code><!-- react-text: 155 -->、<!-- /react-text --><code data-reactid="156">load</code><!-- react-text: 157 -->的区别：<!-- /react-text --></p><ol data-reactid="158"><li data-reactid="159"><code data-reactid="160">DOMContentLoaded</code><!-- react-text: 161 -->是HTML文档（包括CSS、JS）被加载以及解析完成之后触发（即 <!-- /react-text --><code data-reactid="162">HTML-&gt;DOM</code><!-- react-text: 163 -->的过程完成 ）<!-- /react-text --></li><li data-reactid="164"><code data-reactid="165">load</code><!-- react-text: 166 -->则是在页面的其他资源如图片、字体、音频、视频加载完成之后触发<!-- /react-text --></li><li data-reactid="167"><code data-reactid="168">load</code><!-- react-text: 169 -->事件一般在<!-- /react-text --><code data-reactid="170">DOMContentLoaded</code><!-- react-text: 171 -->之后才触发（也有可能在它之前哦）<!-- /react-text --></li></ol><p data-reactid="172">这个时候发现绿色虚线之前有一个浅绿色方块，相应的解释如下：</p><p data-reactid="173"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-5.jpg" data-reactid="174"/></p><p data-reactid="175"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-6.jpg" data-reactid="176"/></p><p data-reactid="177"><!-- react-text: 178 -->由图可以得出“浅绿色”代表的是<!-- /react-text --><strong data-reactid="179">根据CSSOM计算样式并进行布局绘制</strong><!-- react-text: 180 -->的过程，这段时间内浏览器做了一下事情：<!-- /react-text --></p><ol data-reactid="181"><li data-reactid="182"><code data-reactid="183">Recalculate Style</code><!-- react-text: 184 -->:重新计算样式，确定DOM元素的样式规则（定规则）<!-- /react-text --></li><li data-reactid="185"><code data-reactid="186">Layout</code><!-- react-text: 187 -->:根据计算结果进行布局，确定元素的大小和位置（刻章）<!-- /react-text --></li><li data-reactid="188"><code data-reactid="189">Update Layer Tree</code><!-- react-text: 190 -->: 更新渲染层树<!-- /react-text --></li><li data-reactid="191"><code data-reactid="192">Paint</code><!-- react-text: 193 -->: 绘制，根据前面的Layer Tree绘制页面（位置、大小、颜色、边框、阴影等）（盖章）<!-- /react-text --></li><li data-reactid="194"><code data-reactid="195">Composite Layers</code><!-- react-text: 196 -->： 形成层，浏览器按照合理的顺序合并成一个图层然后输出到屏幕（给别人看）<!-- /react-text --></li></ol><p data-reactid="197"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-8.jpg" data-reactid="198"/></p><p data-reactid="199"><!-- react-text: 200 -->那什么时候开始<!-- /react-text --><code data-reactid="201">First paint</code><!-- react-text: 202 -->呢?在浅绿色方块最前面的虚线往前看，发现在灰色虚线之前都会有一个步骤：就是<!-- /react-text --><code data-reactid="203">Parse Stylesheet</code><!-- react-text: 204 -->（调研了很多页面都是如此）<!-- /react-text --></p><p data-reactid="205"><img src="http://eux-blog-static.bj.bcebos.com/fp%2FfirstPaint-9.jpg" data-reactid="206"/></p><p data-reactid="207">所以，First Paint的加载流程应该是这样：</p><ol data-reactid="208"><li data-reactid="209"><strong data-reactid="210">所有的CSS加载完成</strong></li><li data-reactid="211"><strong data-reactid="212"><code data-reactid="213">Parse Stylesheet</code><!-- react-text: 214 -->：构建出CSSOM<!-- /react-text --></strong></li><li data-reactid="215"><strong data-reactid="216"><code data-reactid="217">Recalculate Style</code><!-- react-text: 218 -->：重新计算样式，确定DOM元素的样式规则（定规则）<!-- /react-text --></strong></li><li data-reactid="219"><strong data-reactid="220"><code data-reactid="221">Layout</code><!-- react-text: 222 -->：根据计算结果进行布局，确定元素的大小和位置（刻章）<!-- /react-text --></strong></li><li data-reactid="223"><strong data-reactid="224"><code data-reactid="225">Update Layer Tree</code><!-- react-text: 226 -->：更新渲染层树<!-- /react-text --></strong></li><li data-reactid="227"><strong data-reactid="228"><code data-reactid="229">Paint</code><!-- react-text: 230 -->：绘制，根据前面的Layer Tree绘制页面（位置、大小、颜色、边框、阴影等）（盖章）<!-- /react-text --></strong></li><li data-reactid="231"><strong data-reactid="232"><code data-reactid="233">Composite Layers</code><!-- react-text: 234 -->：形成层，浏览器按照合理的顺序合并成一个图层然后输出到屏幕（给别人看）<!-- /react-text --></strong></li></ol><p data-reactid="235"><!-- react-text: 236 -->但是现在还只是确定了<!-- /react-text --><code data-reactid="237">First Paint</code><!-- react-text: 238 -->的加载流程，也确定了他是在所有CSS执行完<!-- /react-text --><code data-reactid="239">Parse Stylesheet</code><!-- react-text: 240 -->之后才会触发，但是这还是不够准确啊，所以我找了一些CSS和JS的外链来测试，模板如下：<!-- /react-text --></p><pre data-reactid="241"><code class="hljs language-html" data-query="{}" data-lang="html" data-reactid="242"><span class="hljs-meta" data-reactid="243">&lt;!DOCTYPE html&gt;</span><!-- react-text: 244 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="245"><!-- react-text: 246 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="247">html</span><!-- react-text: 248 --> <!-- /react-text --><span class="hljs-attr" data-reactid="249">lang</span><!-- react-text: 250 -->=<!-- /react-text --><span class="hljs-string" data-reactid="251">&quot;en&quot;</span><!-- react-text: 252 -->&gt;<!-- /react-text --></span><!-- react-text: 253 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="254"><!-- react-text: 255 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="256">head</span><!-- react-text: 257 -->&gt;<!-- /react-text --></span><!-- react-text: 258 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="259"><!-- react-text: 260 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="261">meta</span><!-- react-text: 262 --> <!-- /react-text --><span class="hljs-attr" data-reactid="263">charset</span><!-- react-text: 264 -->=<!-- /react-text --><span class="hljs-string" data-reactid="265">&quot;UTF-8&quot;</span><!-- react-text: 266 -->&gt;<!-- /react-text --></span><!-- react-text: 267 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="268"><!-- react-text: 269 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="270">meta</span><!-- react-text: 271 --> <!-- /react-text --><span class="hljs-attr" data-reactid="272">name</span><!-- react-text: 273 -->=<!-- /react-text --><span class="hljs-string" data-reactid="274">&quot;viewport&quot;</span><!-- react-text: 275 --> <!-- /react-text --><span class="hljs-attr" data-reactid="276">content</span><!-- react-text: 277 -->=<!-- /react-text --><span class="hljs-string" data-reactid="278">&quot;width=device-width, initial-scale=1.0&quot;</span><!-- react-text: 279 -->&gt;<!-- /react-text --></span><!-- react-text: 280 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="281"><!-- react-text: 282 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="283">meta</span><!-- react-text: 284 --> <!-- /react-text --><span class="hljs-attr" data-reactid="285">http-equiv</span><!-- react-text: 286 -->=<!-- /react-text --><span class="hljs-string" data-reactid="287">&quot;X-UA-Compatible&quot;</span><!-- react-text: 288 --> <!-- /react-text --><span class="hljs-attr" data-reactid="289">content</span><!-- react-text: 290 -->=<!-- /react-text --><span class="hljs-string" data-reactid="291">&quot;ie=edge&quot;</span><!-- react-text: 292 -->&gt;<!-- /react-text --></span><!-- react-text: 293 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="294"><!-- react-text: 295 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="296">title</span><!-- react-text: 297 -->&gt;<!-- /react-text --></span><!-- react-text: 298 -->Document<!-- /react-text --><span class="hljs-tag" data-reactid="299"><!-- react-text: 300 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="301">title</span><!-- react-text: 302 -->&gt;<!-- /react-text --></span><!-- react-text: 303 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="304"><!-- react-text: 305 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="306">link</span><!-- react-text: 307 --> <!-- /react-text --><span class="hljs-attr" data-reactid="308">href</span><!-- react-text: 309 -->=<!-- /react-text --><span class="hljs-string" data-reactid="310">&quot;https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.css&quot;</span><!-- react-text: 311 --> <!-- /react-text --><span class="hljs-attr" data-reactid="312">rel</span><!-- react-text: 313 -->=<!-- /react-text --><span class="hljs-string" data-reactid="314">&quot;stylesheet&quot;</span><!-- react-text: 315 -->&gt;<!-- /react-text --></span><!-- react-text: 316 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="317"><!-- react-text: 318 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="319">link</span><!-- react-text: 320 --> <!-- /react-text --><span class="hljs-attr" data-reactid="321">href</span><!-- react-text: 322 -->=<!-- /react-text --><span class="hljs-string" data-reactid="323">&quot;https://cdn.bootcss.com/jqueryui/1.12.1/jquery-ui.css&quot;</span><!-- react-text: 324 --> <!-- /react-text --><span class="hljs-attr" data-reactid="325">rel</span><!-- react-text: 326 -->=<!-- /react-text --><span class="hljs-string" data-reactid="327">&quot;stylesheet&quot;</span><!-- react-text: 328 -->&gt;<!-- /react-text --></span><!-- react-text: 329 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="330"><!-- react-text: 331 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="332">script</span><!-- react-text: 333 --> <!-- /react-text --><span class="hljs-attr" data-reactid="334">src</span><!-- react-text: 335 -->=<!-- /react-text --><span class="hljs-string" data-reactid="336">&quot;https://cdn.bootcss.com/vue/2.5.13/vue.js&quot;</span><!-- react-text: 337 -->&gt;<!-- /react-text --></span><span class="null" data-reactid="338"></span><span class="hljs-tag" data-reactid="339"><!-- react-text: 340 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="341">script</span><!-- react-text: 342 -->&gt;<!-- /react-text --></span><!-- react-text: 343 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="344"><!-- react-text: 345 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="346">script</span><!-- react-text: 347 --> <!-- /react-text --><span class="hljs-attr" data-reactid="348">src</span><!-- react-text: 349 -->=<!-- /react-text --><span class="hljs-string" data-reactid="350">&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;</span><!-- react-text: 351 -->&gt;<!-- /react-text --></span><span class="null" data-reactid="352"></span><span class="hljs-tag" data-reactid="353"><!-- react-text: 354 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="355">script</span><!-- react-text: 356 -->&gt;<!-- /react-text --></span><!-- react-text: 357 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="358"><!-- react-text: 359 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="360">script</span><!-- react-text: 361 --> <!-- /react-text --><span class="hljs-attr" data-reactid="362">src</span><!-- react-text: 363 -->=<!-- /react-text --><span class="hljs-string" data-reactid="364">&quot;https://cdn.bootcss.com/react/16.4.0-alpha.0911da3/cjs/react.development.js&quot;</span><!-- react-text: 365 -->&gt;<!-- /react-text --></span><span class="null" data-reactid="366"></span><span class="hljs-tag" data-reactid="367"><!-- react-text: 368 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="369">script</span><!-- react-text: 370 -->&gt;<!-- /react-text --></span><!-- react-text: 371 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="372"><!-- react-text: 373 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="374">script</span><!-- react-text: 375 --> <!-- /react-text --><span class="hljs-attr" data-reactid="376">src</span><!-- react-text: 377 -->=<!-- /react-text --><span class="hljs-string" data-reactid="378">&quot;https://cdn.bootcss.com/angular.js/2.0.0-beta.17/angular2.js&quot;</span><!-- react-text: 379 -->&gt;<!-- /react-text --></span><span class="null" data-reactid="380"></span><span class="hljs-tag" data-reactid="381"><!-- react-text: 382 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="383">script</span><!-- react-text: 384 -->&gt;<!-- /react-text --></span><!-- react-text: 385 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="386"><!-- react-text: 387 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="388">head</span><!-- react-text: 389 -->&gt;<!-- /react-text --></span><!-- react-text: 390 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="391"><!-- react-text: 392 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="393">body</span><!-- react-text: 394 -->&gt;<!-- /react-text --></span><!-- react-text: 395 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="396"><!-- react-text: 397 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="398">div</span><!-- react-text: 399 --> <!-- /react-text --><span class="hljs-attr" data-reactid="400">id</span><!-- react-text: 401 -->=<!-- /react-text --><span class="hljs-string" data-reactid="402">&#x27;root1&#x27;</span><!-- react-text: 403 -->&gt;<!-- /react-text --></span><!-- react-text: 404 -->
        1
    <!-- /react-text --><span class="hljs-tag" data-reactid="405"><!-- react-text: 406 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="407">div</span><!-- react-text: 408 -->&gt;<!-- /react-text --></span><!-- react-text: 409 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="410"><!-- react-text: 411 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="412">div</span><!-- react-text: 413 --> <!-- /react-text --><span class="hljs-attr" data-reactid="414">id</span><!-- react-text: 415 -->=<!-- /react-text --><span class="hljs-string" data-reactid="416">&#x27;root2&#x27;</span><!-- react-text: 417 -->&gt;<!-- /react-text --></span><!-- react-text: 418 -->
        2
    <!-- /react-text --><span class="hljs-tag" data-reactid="419"><!-- react-text: 420 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="421">div</span><!-- react-text: 422 -->&gt;<!-- /react-text --></span><!-- react-text: 423 -->
    <!-- /react-text --><span class="hljs-tag" data-reactid="424"><!-- react-text: 425 -->&lt;<!-- /react-text --><span class="hljs-name" data-reactid="426">div</span><!-- react-text: 427 --> <!-- /react-text --><span class="hljs-attr" data-reactid="428">id</span><!-- react-text: 429 -->=<!-- /react-text --><span class="hljs-string" data-reactid="430">&#x27;root3&#x27;</span><!-- react-text: 431 -->&gt;<!-- /react-text --></span><!-- react-text: 432 -->
        3
    <!-- /react-text --><span class="hljs-tag" data-reactid="433"><!-- react-text: 434 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="435">div</span><!-- react-text: 436 -->&gt;<!-- /react-text --></span><!-- react-text: 437 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="438"><!-- react-text: 439 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="440">body</span><!-- react-text: 441 -->&gt;<!-- /react-text --></span><!-- react-text: 442 -->
<!-- /react-text --><span class="hljs-tag" data-reactid="443"><!-- react-text: 444 -->&lt;/<!-- /react-text --><span class="hljs-name" data-reactid="445">html</span><!-- react-text: 446 -->&gt;<!-- /react-text --></span></code></pre><p data-reactid="447">我们通过改变上面模板里的外链顺序来探究：</p><h3 id="第一种情况：" data-reactid="448"><a href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="449"><span class="icon icon-link" data-reactid="450"></span></a><!-- react-text: 451 -->第一种情况：<!-- /react-text --></h3><p data-reactid="452"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F1%2FSnipaste_2018-04-23_19-29-12.png" data-reactid="453"/><!-- react-text: 454 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F1%2FSnipaste_2018-04-23_19-31-12.png" data-reactid="455"/></p><p data-reactid="456"><!-- react-text: 457 -->发现FP发生在最后（实心的蓝色线是按<!-- /react-text --><code data-reactid="458">shift</code><!-- react-text: 459 -->出来的，不是<!-- /react-text --><code data-reactid="460">DOMContentLoaded</code><!-- react-text: 461 -->）,现在还发现不了什么。<!-- /react-text --></p><h3 id="第二种情况：" data-reactid="462"><a href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="463"><span class="icon icon-link" data-reactid="464"></span></a><!-- react-text: 465 -->第二种情况：<!-- /react-text --></h3><p data-reactid="466"><!-- react-text: 467 -->调换<!-- /react-text --><code data-reactid="468">head</code><!-- react-text: 469 -->中CSS和JS外链位置<!-- /react-text --></p><p data-reactid="470"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F2%2FSnipaste_2018-04-23_19-31-59.png" data-reactid="471"/><!-- react-text: 472 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F2%2FSnipaste_2018-04-23_19-33-03.png" data-reactid="473"/></p><p data-reactid="474">仍然发现不了什么</p><h3 id="第三种情况" data-reactid="475"><a href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%83%85%E5%86%B5" aria-hidden="true" data-reactid="476"><span class="icon icon-link" data-reactid="477"></span></a><!-- react-text: 478 -->第三种情况<!-- /react-text --></h3><p data-reactid="479"><!-- react-text: 480 -->把CSS放<!-- /react-text --><code data-reactid="481">head</code><!-- react-text: 482 -->，JS放<!-- /react-text --><code data-reactid="483">&lt;/body&gt;</code><!-- react-text: 484 -->前<!-- /react-text --></p><p data-reactid="485"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F3%2FSnipaste_2018-04-23_19-31-59.png" data-reactid="486"/><!-- react-text: 487 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F3%2FSnipaste_2018-04-23_19-38-26.png" data-reactid="488"/></p><p data-reactid="489"><!-- react-text: 490 -->发现<!-- /react-text --><code data-reactid="491">FP</code><!-- react-text: 492 -->竟然在蓝色和红色虚线前面出现，通过这点可以确定，<!-- /react-text --><code data-reactid="493">FP</code><!-- react-text: 494 -->还跟JS外链的位置有关，继续:<!-- /react-text --></p><h3 id="第四种情况：" data-reactid="495"><a href="#%E7%AC%AC%E5%9B%9B%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="496"><span class="icon icon-link" data-reactid="497"></span></a><!-- react-text: 498 -->第四种情况：<!-- /react-text --></h3><p data-reactid="499"><!-- react-text: 500 -->JS外链放<!-- /react-text --><code data-reactid="501">head</code><!-- react-text: 502 -->，CSS放<!-- /react-text --><code data-reactid="503">&lt;/body&gt;</code><!-- react-text: 504 -->前<!-- /react-text --></p><p data-reactid="505"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F4%2FSnipaste_2018-04-23_19-39-23.png" data-reactid="506"/><!-- react-text: 507 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F4%2FSnipaste_2018-04-23_19-39-52.png" data-reactid="508"/></p><p data-reactid="509">发现又跟第一二种情况一样了，所以这种用法是不可取的。</p><h3 id="第五种情况：" data-reactid="510"><a href="#%E7%AC%AC%E4%BA%94%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="511"><span class="icon icon-link" data-reactid="512"></span></a><!-- react-text: 513 -->第五种情况：<!-- /react-text --></h3><p data-reactid="514"><!-- react-text: 515 -->CSS和JS都放<!-- /react-text --><code data-reactid="516">&lt;/body&gt;</code><!-- react-text: 517 -->前，且CSS紧贴在<!-- /react-text --><code data-reactid="518">div</code><!-- react-text: 519 -->后面，JS在CSS后面：<!-- /react-text --></p><p data-reactid="520"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F5%2FSnipaste_2018-04-23_19-40-18.png" data-reactid="521"/><!-- react-text: 522 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F5%2FSnipaste_2018-04-23_19-41-21.png" data-reactid="523"/></p><p data-reactid="524"><!-- react-text: 525 -->可以发现<!-- /react-text --><code data-reactid="526">FP</code><!-- react-text: 527 -->居然更快触发，<!-- /react-text --><strong data-reactid="528"><!-- react-text: 529 -->但是我鼠标hover到绿色虚线后，仍然是白屏，只有等到CSS加载完成执行<!-- /react-text --><code data-reactid="530">Parse Stylesheet</code><!-- react-text: 531 -->之后才显示出内容<!-- /react-text --></strong><!-- react-text: 532 -->（说明这种用法也不可取），难道body中的CSS也会影响？<!-- /react-text --></p><h3 id="第六种情况：" data-reactid="533"><a href="#%E7%AC%AC%E5%85%AD%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="534"><span class="icon icon-link" data-reactid="535"></span></a><!-- react-text: 536 -->第六种情况：<!-- /react-text --></h3><p data-reactid="537">掉换一下上面CSS和JS的位置：</p><p data-reactid="538"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F6%2FSnipaste_2018-04-23_19-41-55.png" data-reactid="539"/><!-- react-text: 540 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F6%2FSnipaste_2018-04-23_19-42-29.png" data-reactid="541"/></p><p data-reactid="542"><!-- react-text: 543 -->发现这次<!-- /react-text --><code data-reactid="544">FP</code><!-- react-text: 545 -->触发而且立马有内容，而等到CSS加载完成之后还会再重新渲染一次，嗯，看来body中的第一个JS脚本有猫腻，接下来的情况对他特殊照顾。<!-- /react-text --></p><h3 id="第七种情况：" data-reactid="546"><a href="#%E7%AC%AC%E4%B8%83%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="547"><span class="icon icon-link" data-reactid="548"></span></a><!-- react-text: 549 -->第七种情况：<!-- /react-text --></h3><p data-reactid="550"><!-- react-text: 551 -->CSS放<!-- /react-text --><code data-reactid="552">head</code><!-- react-text: 553 -->中，JS放在<!-- /react-text --><code data-reactid="554">div</code><!-- react-text: 555 -->节点中间：<!-- /react-text --></p><p data-reactid="556"><img src="http://eux-blog-static.bj.bcebos.com/fp%2F7%2FSnipaste_2018-04-23_19-43-08.png" data-reactid="557"/><!-- react-text: 558 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2F7%2FSnipaste_2018-04-23_19-43-49.png" data-reactid="559"/></p><p data-reactid="560">哈哈，居然只渲染了12俩字，说明浏览器会渲染body中脚本之前的内容，那会是哪个脚本之前的内容呢？</p><h3 id="第八种情况：" data-reactid="561"><a href="#%E7%AC%AC%E5%85%AB%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="562"><span class="icon icon-link" data-reactid="563"></span></a><!-- react-text: 564 -->第八种情况：<!-- /react-text --></h3><p data-reactid="565">在div之间都插入脚本</p><p data-reactid="566"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-07-03.jpg" data-reactid="567"/><!-- react-text: 568 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-06-52.jpg" data-reactid="569"/></p><p data-reactid="570"><!-- react-text: 571 -->看来浏览器会提前渲染<!-- /react-text --><code data-reactid="572">body</code><!-- react-text: 573 -->中第一个脚本前的内容（<!-- /react-text --><code data-reactid="574">我们就把body中的第一个外链脚本叫做【第一脚本】吧</code><!-- react-text: 575 -->），并且<!-- /react-text --><strong data-reactid="576">第一脚本</strong><!-- react-text: 577 -->还会在FP之后才执行。所以结合之前得出的结论，在CSSOM准备就绪之后，浏览器会提前渲染第一脚本前的内容，我们可以用第九种情况来验证：<!-- /react-text --></p><h3 id="第九种情况：" data-reactid="578"><a href="#%E7%AC%AC%E4%B9%9D%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="579"><span class="icon icon-link" data-reactid="580"></span></a><!-- react-text: 581 -->第九种情况：<!-- /react-text --></h3><p data-reactid="582"><!-- react-text: 583 -->这种情况和上种没什么区别，只是增加了一个CSS，这个CSS中还会发出一个请求去加载其他CSS（通过<!-- /react-text --><code data-reactid="584">@import url()</code><!-- react-text: 585 -->的方式），所以CSS的加载时间很长。<!-- /react-text --></p><p data-reactid="586"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-19-44.jpg" data-reactid="587"/><!-- react-text: 588 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-19-35.jpg" data-reactid="589"/></p><p data-reactid="590"><!-- react-text: 591 -->通过结果可以看出，123在CSS下载完成之后才渲染，而不是单独渲染一个1，所以<!-- /react-text --><code data-reactid="592">FP</code><!-- react-text: 593 -->必须得等到<!-- /react-text --><code data-reactid="594">CSSOM</code><!-- react-text: 595 -->准备就绪之后才会触发，否则即使有第一脚本在也没用。 所以到这里，我们总算可以下结论了：<!-- /react-text --></p><blockquote data-reactid="596"><p data-reactid="597"><strong data-reactid="598"><!-- react-text: 599 -->FP发生在body中第一个script脚本之前的CSS解析和JS执行完成之后。换句话说就是第一脚本之前的<!-- /react-text --><code data-reactid="600">DOM</code><!-- react-text: 601 -->和<!-- /react-text --><code data-reactid="602">CSSOM</code><!-- react-text: 603 -->准备就绪之后，便会着手渲染第一脚本前的内容。<!-- /react-text --></strong></p></blockquote><p data-reactid="604">但是...你以为到这里就结束了？其实没有。</p><h3 id="第十种情况：" data-reactid="605"><a href="#%E7%AC%AC%E5%8D%81%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-hidden="true" data-reactid="606"><span class="icon icon-link" data-reactid="607"></span></a><!-- react-text: 608 -->第十种情况：<!-- /react-text --></h3><p data-reactid="609"><!-- react-text: 610 -->这种情况中，<!-- /react-text --><code data-reactid="611">head</code><!-- react-text: 612 -->中既有JS也有CSS，<!-- /react-text --><code data-reactid="613">body</code><!-- react-text: 614 -->中也有第一脚本存在：<!-- /react-text --></p><p data-reactid="615"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-34-55.jpg" data-reactid="616"/><!-- react-text: 617 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-35-11.jpg" data-reactid="618"/></p><p data-reactid="619"><!-- react-text: 620 -->注意上图中的<!-- /react-text --><code data-reactid="621">vue.js</code><!-- react-text: 622 -->是在<!-- /react-text --><code data-reactid="623">head</code><!-- react-text: 624 -->中的，而后面的JS文件都在<!-- /react-text --><code data-reactid="625">body</code><!-- react-text: 626 -->中，而且，<!-- /react-text --><code data-reactid="627">vue.js</code><!-- react-text: 628 -->加载完成之后，<!-- /react-text --><code data-reactid="629">body</code><!-- react-text: 630 -->中的JS还没下载完成，这个时候我们调换一下<!-- /react-text --><code data-reactid="631">vue.js</code><!-- react-text: 632 -->和<!-- /react-text --><code data-reactid="633">angular2.js</code><!-- react-text: 634 -->的位置：<!-- /react-text --></p><p data-reactid="635"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-37-53.jpg" data-reactid="636"/><!-- react-text: 637 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-15-37-46.jpg" data-reactid="638"/></p><p data-reactid="639">看，这个时候又没有提前渲染了，123等到所有JS文件都执行完之后才渲染，这种情况除了验证了第九点的结论，还能补充我们的结论：</p><blockquote data-reactid="640"><p data-reactid="641"><strong data-reactid="642"><!-- react-text: 643 -->如果第一脚本前的JS和CSS加载完了，<!-- /react-text --><code data-reactid="644">body</code><!-- react-text: 645 -->中的脚本还未下载完成，那么浏览器就会利用构建好的局部<!-- /react-text --><code data-reactid="646">CSSOM</code><!-- react-text: 647 -->和<!-- /react-text --><code data-reactid="648">DOM</code><!-- react-text: 649 -->提前渲染第一脚本前的内容（触发<!-- /react-text --><code data-reactid="650">FP</code><!-- react-text: 651 -->）；如果第一脚本前的JS和CSS都还没下载完成，<!-- /react-text --><code data-reactid="652">body</code><!-- react-text: 653 -->中的脚本就已经下载完了，那么浏览器就会在所有JS脚本都执行完之后才触发FP。<!-- /react-text --></strong></p></blockquote><p data-reactid="654">到这里本次探究就结束了，其实还有很多种情况，感兴趣的可以自己去试试。</p><h2 id="建议：" data-reactid="655"><a href="#%E5%BB%BA%E8%AE%AE%EF%BC%9A" aria-hidden="true" data-reactid="656"><span class="icon icon-link" data-reactid="657"></span></a><!-- react-text: 658 -->建议：<!-- /react-text --></h2><ul data-reactid="659"><li data-reactid="660"><!-- react-text: 661 -->CSS放在head中，JS放在<!-- /react-text --><code data-reactid="662">&lt;/body&gt;</code><!-- react-text: 663 -->前（如果在head必须放JS，也尽量减少他的大小，把大JS文件放<!-- /react-text --><code data-reactid="664">&lt;/body&gt;</code><!-- react-text: 665 -->前）。<!-- /react-text --></li><li data-reactid="666"><!-- react-text: 667 -->减小head中CSS和JS大小（<!-- /react-text --><code data-reactid="668">gzip</code><a href="https://segmentfault.com/a/1190000012800222" data-reactid="669">了解一下？</a><!-- react-text: 670 -->)，<!-- /react-text --></li><li data-reactid="671"><!-- react-text: 672 -->优化head中的JS和CSS外链的网络情况，减少<!-- /react-text --><code data-reactid="673">Stalled</code><!-- react-text: 674 -->、<!-- /react-text --><code data-reactid="675">TTFB</code><!-- react-text: 676 -->和<!-- /react-text --><code data-reactid="677">Content Download</code><!-- react-text: 678 -->的时间。<!-- /react-text --></li><li data-reactid="679">在第一脚本前使用骨架图，可以减少用户的白屏感知时间（对于使用JS插入模板来渲染的框架，建议将骨架图的路由生成逻辑单独提出来）</li></ul><h2 id="科普一下" data-reactid="680"><a href="#%E7%A7%91%E6%99%AE%E4%B8%80%E4%B8%8B" aria-hidden="true" data-reactid="681"><span class="icon icon-link" data-reactid="682"></span></a><!-- react-text: 683 -->科普一下<!-- /react-text --></h2><ul data-reactid="684"><li data-reactid="685"><code data-reactid="686">Chrome</code><!-- react-text: 687 -->会渲染局部<!-- /react-text --><code data-reactid="688">CSSOM</code><!-- react-text: 689 -->和<!-- /react-text --><code data-reactid="690">DOM</code></li><li data-reactid="691"><code data-reactid="692">First Paint</code><!-- react-text: 693 -->和<!-- /react-text --><code data-reactid="694">DOMContentLoaded</code><!-- react-text: 695 -->、<!-- /react-text --><code data-reactid="696">load</code><!-- react-text: 697 -->事件的触发没有绝对的关系，<!-- /react-text --><code data-reactid="698">FP</code><!-- react-text: 699 -->可能在他们之前，也可能在他们之后，这取决于影响他们触发的因素的各自时间（<!-- /react-text --><code data-reactid="700">FP</code><!-- react-text: 701 -->：<!-- /react-text --><code data-reactid="702">第一脚本</code><!-- react-text: 703 -->前<!-- /react-text --><code data-reactid="704">CSSOM</code><!-- react-text: 705 -->和<!-- /react-text --><code data-reactid="706">DOM</code><!-- react-text: 707 -->的构建速度；<!-- /react-text --><code data-reactid="708">DOMContentLoaded</code><!-- react-text: 709 -->：<!-- /react-text --><code data-reactid="710">HTML</code><!-- react-text: 711 -->文档自身以及<!-- /react-text --><code data-reactid="712">HTML</code><!-- react-text: 713 -->文档中所有<!-- /react-text --><code data-reactid="714">JS</code><!-- react-text: 715 -->、<!-- /react-text --><code data-reactid="716">CSS</code><!-- react-text: 717 -->的加载速度；<!-- /react-text --><code data-reactid="718">load</code><!-- react-text: 719 -->：图片、音频、视频、字体的加载速度）。<!-- /react-text --></li><li data-reactid="720"><code data-reactid="721">DOMContentLoaded</code><!-- react-text: 722 -->和<!-- /react-text --><code data-reactid="723">load</code><!-- react-text: 724 -->事件也没有强制的先后顺序，<!-- /react-text --><code data-reactid="725">DOMContentLoaded</code><!-- react-text: 726 -->一般在<!-- /react-text --><code data-reactid="727">load</code><!-- react-text: 728 -->事件之前触发，但也可能在<!-- /react-text --><code data-reactid="729">load</code><!-- react-text: 730 -->事件之后触发。<!-- /react-text --></li><li data-reactid="731"><code data-reactid="732">第一脚本</code><!-- react-text: 733 -->前的CSS如果还会去加载字体文件，那么即使<!-- /react-text --><code data-reactid="734">CSSOM</code><!-- react-text: 735 -->和<!-- /react-text --><code data-reactid="736">DOM</code><!-- react-text: 737 -->构建完成触发<!-- /react-text --><code data-reactid="738">FP</code><!-- react-text: 739 -->，页面内容也会是空白，只有等到字体文件下载完成才会出现内容（这也是我们在打开一个加载了谷歌字体的网站会白屏很长时间的原因）。<!-- /react-text --></li><li data-reactid="740"><!-- react-text: 741 -->默认情况下，<!-- /react-text --><code data-reactid="742">CSS</code><!-- react-text: 743 -->外链之间是谁先加载完成谁先解析，但是<!-- /react-text --><code data-reactid="744">JS</code><!-- react-text: 745 -->外链之间即使先加载完成，也得按顺序执行。<!-- /react-text --></li><li data-reactid="746"><code data-reactid="747">link</code><!-- react-text: 748 -->外链后面紧跟<!-- /react-text --><code data-reactid="749">script</code><!-- react-text: 750 -->外链，须先等<!-- /react-text --><code data-reactid="751">link parse</code><!-- react-text: 752 -->完成之后，<!-- /react-text --><code data-reactid="753">script</code><!-- react-text: 754 -->才会执行，即使<!-- /react-text --><code data-reactid="755">script</code><!-- react-text: 756 -->先下载完成。<!-- /react-text --><code data-reactid="757">script</code><!-- react-text: 758 -->后面紧跟<!-- /react-text --><code data-reactid="759">link</code><!-- react-text: 760 -->，也是一样，会等<!-- /react-text --><code data-reactid="761">script</code><!-- react-text: 762 -->执行完之后，<!-- /react-text --><code data-reactid="763">link</code><!-- react-text: 764 -->才会<!-- /react-text --><code data-reactid="765">parse</code><!-- react-text: 766 -->。<!-- /react-text --></li><li data-reactid="767"><!-- react-text: 768 -->如果<!-- /react-text --><code data-reactid="769">script</code><!-- react-text: 770 -->之后紧跟几个<!-- /react-text --><code data-reactid="771">link</code><!-- react-text: 772 -->且<!-- /react-text --><code data-reactid="773">script</code><!-- react-text: 774 -->比这几个<!-- /react-text --><code data-reactid="775">link</code><!-- react-text: 776 -->的下载时间都长，那<!-- /react-text --><code data-reactid="777">script</code><!-- react-text: 778 -->执行完成之后<!-- /react-text --><code data-reactid="779">link</code><!-- react-text: 780 -->是按顺序执行。<!-- /react-text --></li><li data-reactid="781"><p data-reactid="782"><code data-reactid="783">RRDL</code><!-- react-text: 784 -->：<!-- /react-text --></p><ul data-reactid="785"><li data-reactid="786"><!-- react-text: 787 -->R：send <!-- /react-text --><strong data-reactid="788">R</strong><!-- react-text: 789 -->equest，发送资源请求<!-- /react-text --></li><li data-reactid="790"><!-- react-text: 791 -->R：receive <!-- /react-text --><strong data-reactid="792">R</strong><!-- react-text: 793 -->esponse，接收到服务端响应<!-- /react-text --></li><li data-reactid="794"><!-- react-text: 795 -->D：receive <!-- /react-text --><strong data-reactid="796">D</strong><!-- react-text: 797 -->ata，开始接受服务端数据(一个资源可能执行多次)<!-- /react-text --></li><li data-reactid="798"><!-- react-text: 799 -->L：finish <!-- /react-text --><strong data-reactid="800">L</strong><!-- react-text: 801 -->oading，完成资源下载<!-- /react-text --></li></ul></li><li data-reactid="802"><!-- react-text: 803 -->浏览器在<!-- /react-text --><code data-reactid="804">RRDL</code><!-- react-text: 805 -->的时候，在<!-- /react-text --><code data-reactid="806">D（Receive data）</code><!-- react-text: 807 -->这个步骤可能执行多次。<!-- /react-text --></li><li data-reactid="808"><code data-reactid="809">TTFB</code><!-- react-text: 810 -->:<!-- /react-text --><code data-reactid="811">Time To First Byte</code><!-- react-text: 812 -->，第一个字节返回的时间，这个是对应<!-- /react-text --><code data-reactid="813">send Request</code><!-- react-text: 814 -->到<!-- /react-text --><code data-reactid="815">receive Response</code><!-- react-text: 816 -->这段时间。<!-- /react-text --></li><li data-reactid="817"><!-- react-text: 818 -->浏览器会给HTML中的资源文件进行等级分类（<!-- /react-text --><code data-reactid="819">Hightest/High/Meduim/Low/Lowest</code><!-- react-text: 820 -->）,一般<!-- /react-text --><code data-reactid="821">HTML</code><!-- react-text: 822 -->文档自身、<!-- /react-text --><code data-reactid="823">head</code><!-- react-text: 824 -->中的CSS都是<!-- /react-text --><code data-reactid="825">Hightest</code><!-- react-text: 826 -->，<!-- /react-text --><code data-reactid="827">head</code><!-- react-text: 828 -->中JS一般是<!-- /react-text --><code data-reactid="829">High</code><!-- react-text: 830 -->，而图片一般是<!-- /react-text --><code data-reactid="831">Low</code><!-- react-text: 832 -->，而设置了<!-- /react-text --><code data-reactid="833">async/defer</code><!-- react-text: 834 -->的脚本一般是<!-- /react-text --><code data-reactid="835">Low</code><!-- react-text: 836 -->，<!-- /react-text --><code data-reactid="837">gif</code><!-- react-text: 838 -->图片一般是<!-- /react-text --><code data-reactid="839">Lowest</code><!-- react-text: 840 -->。<!-- /react-text --></li><li data-reactid="841">下图中的资源文件浅色和深色和第二个图画红框的位置是对应的（不信自己计算一下对应的时间）</li></ul><p data-reactid="842"><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-16-04-40.jpg" data-reactid="843"/><!-- react-text: 844 --> <!-- /react-text --><img src="http://eux-blog-static.bj.bcebos.com/fp%2Fnew%2F2018-04-13-16-05-44.jpg" data-reactid="845"/></p><p data-reactid="846">参考链接：</p><ol data-reactid="847"><li data-reactid="848"><a href="https://developers.google.cn/web/fundamentals/performance/critical-rendering-path/analyzing-crp?hl=zh-cn" data-reactid="849">分析关键渲染路径性能</a></li><li data-reactid="850"><a href="http://harttle.land/2016/11/26/static-dom-render-blocking.html" data-reactid="851">CSS/JS对DOM渲染的影响</a></li><li data-reactid="852"><a href="https://github.com/amfe/article/issues/47" data-reactid="853">CSS Animation性能优化</a></li></ol></article><div data-reactid="854"></div><nav class="single-bar clearfix" data-reactid="855"><span class="prev" data-reactid="856"><a rel="prev" href="/blog/fe/浏览器环境下使用Protocol Buffers" data-reactid="857"><em class="eux-icon eux-icon-page-prev" data-reactid="858"></em><!-- react-text: 859 -->在浏览器环境下使用Protocol Buffers协议<!-- /react-text --></a></span><span class="next" data-reactid="860"><a rel="next" href="/blog/fe/关于js中的浮点运算" data-reactid="861"><em class="eux-icon eux-icon-page-next" data-reactid="862"></em><!-- react-text: 863 -->关于 js 中的浮点计算<!-- /react-text --></a></span></nav></div></div></div><footer class="footer" data-reactid="864"><div class="eux-footer-area-wrapper container-singular" role="complementary" data-reactid="865"><div class="inner clearfix" data-reactid="866"><aside id="simple-links-2" class="widget sl-links-main" data-reactid="867"><h2 class="widgettitle" data-reactid="868">友情链接</h2><ul class="simple-links-list simple-links-2-list" id="simple-links-2-list" data-reactid="869"><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="870"><a target="_blank" href="http://sux.baidu.com/" title="百度 FEX 团队" data-reactid="871">百度 FEX</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="872"><a target="_blank" href="http://efe.baidu.com/" title="百度 EFE 团队" data-reactid="873">百度 EFE</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="874"><a target="_blank" href="http://sux.baidu.com/" title="百度 SUX 团队" data-reactid="875">百度 SUX</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="876"><a target="_blank" href="https://aotu.io/" title="京东凹凸实验室，面向多终端技术体系，致力于构建沉淀与分享包括但不限于交互、页面制作技巧、前端开发、原生APP开发等方面的专业知识及案例。" data-reactid="877">凹凸实验室</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="878"><a target="_blank" href="https://fed.renren.com/" title="人人网FED" data-reactid="879">人人网FED</a></li></ul></aside></div></div><div class="eux-icp" data-reactid="880"><!-- react-text: 881 -->百度EUX 版权所有 ©百度EUX    All rights reserved. 骄傲地采用 <!-- /react-text --><a target="_blank" href="https://github.com/picidaejs/picidaejs" data-reactid="882">Picidae</a><!-- react-text: 883 -->。<!-- /react-text --></div></footer></div>
</div>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>