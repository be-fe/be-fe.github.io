<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 如何进行EDM邮件制作 | 百度EUX </title>
    <link rel="stylesheet" href="/style.css">
    <script>
      (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?d232748d06c1fe09a6db3db0077669b7";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();

      var _vds = _vds || [];
      window._vds = _vds;
      (function () {
        _vds.push(['setAccountId', '66707fb8b27442d5b3ccca57a56800fa']);
        _vds.push(['trackBot', false]);

        (function () {
          var vds = document.createElement('script');
          vds.type = 'text/javascript';
          vds.async = true;
          vds.src = '//dn-growing.qbox.me/vds.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(vds, s);
        })();
      })();
    </script>
</head>
<body>
<div id="root">
    <div class="main" data-reactroot="" data-reactid="1" data-react-checksum="-378838228"><!-- react-empty: 2 --><header class="eux-header clearfix" data-reactid="3"><div class="eux-header-top" data-reactid="4"><a href="javascript:void(0);" class="eux-portable-menu" data-reactid="5"><span data-reactid="6"></span><span data-reactid="7"></span><span data-reactid="8"></span></a><!-- react-empty: 9 --><nav class="menu-primary-container" data-reactid="10"><ul id="menu-primary" class="menu" data-reactid="11"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25" data-reactid="12"><a href="/" data-reactid="13">HOME</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom current-menu-ancestor current-menu-parent menu-item-has-children menu-item-45" data-reactid="14"><a href="/" data-reactid="15">BLOG</a><ul class="sub-menu" data-reactid="16"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="17"><a href="/ue" data-reactid="18">交互</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="19"><a href="/ui" data-reactid="20">视觉</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="21"><a href="/fe" data-reactid="22">前端</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="23"><a href="/team" data-reactid="24">团队</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-46" data-reactid="25"><a href="/tools" data-reactid="26">TOOLS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-112" data-reactid="27"><a href="/works" data-reactid="28">WORKS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-138" data-reactid="29"><a href="/jobs" data-reactid="30">JOBS</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50" data-reactid="31"><a href="/about-us" data-reactid="32">ABOUT US</a></li></ul></nav></div></header><div class="eux-singular clearfix" data-reactid="33"><div class="container-singular clearfix" data-reactid="34"><nav class="menu-categories-container" data-reactid="35"><ul id="menu-categories" class="menu" data-reactid="36"><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="37"><span data-reactid="38"><a href="/" data-reactid="39">全部</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="40"><span data-reactid="41"><a href="/ue" data-reactid="42">交互</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="43"><span data-reactid="44"><a href="/ui" data-reactid="45">视觉</a></span></li><li class="current-menu-item menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="46"><span data-reactid="47"><a href="/fe" data-reactid="48">前端</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="49"><span data-reactid="50"><a href="/team" data-reactid="51">团队</a></span></li></ul></nav><div class="inner clearfix" data-reactid="52"><div class="article-meta" data-reactid="53"><h1 class="title" data-reactid="54">如何进行EDM邮件制作</h1><div class="eux-page-detail" data-reactid="55"><span data-reactid="56"><em data-reactid="57">by.</em><!-- react-text: 58 -->谢 郁<!-- /react-text --></span><span data-reactid="59">2017-12-13</span></div></div><article data-reactid="60"><p data-reactid="61"><!-- react-text: 62 -->首先，制作EDM邮件的一个准则就是使用table布局和inline style，因为很多样式和标签邮件客户端是不识别的，再一个外部资源引入的CSS/JS和写在<!-- /react-text --><style data-reactid="63">标签里的CSS很多时候都会被邮件客户端干掉。这两点是我们开篇的基础知识。</style></p><h3 id="a-sad-story" data-reactid="64"><a href="#a-sad-story" aria-hidden="true" data-reactid="65"><span class="icon icon-link" data-reactid="66"></span></a><!-- react-text: 67 -->A Sad Story<!-- /react-text --></h3><p data-reactid="68"><!-- react-text: 69 -->一开始，我们使用了网页三剑客之DreamWaver，在一整张图片上使用<!-- /react-text --><code data-reactid="70">&lt;map&gt;</code><!-- react-text: 71 -->标签增加链接，网页和outlook里测试都非常perfect，但是放到Mac客户端里，链接无法被识别出来。<!-- /react-text --></p><p data-reactid="72">然后我们又使用了网页三剑客之Photoshop，对整张图进行了切片，并给切片附上了链接，然后直接导出为html，出来直接就是table布局，一些常用的样式，比如:</p><pre data-reactid="73"><code class="hljs language-css" data-query="{}" data-lang="css" data-reactid="74"><span class="hljs-selector-tag" data-reactid="75">border</span><!-- react-text: 76 -->=0
<!-- /react-text --><span class="hljs-selector-tag" data-reactid="77">cellpadding</span><!-- react-text: 78 -->=0
<!-- /react-text --><span class="hljs-selector-tag" data-reactid="79">cellspacing</span><!-- react-text: 80 -->=0<!-- /react-text --></code></pre><p data-reactid="81">这些都已经以inline的形式加入到table里了，看起来很完美了，可是发出去以后windows下的outlook显示有白边：效果是这样的：</p><!-- react-text: 82 -->&lt;img src=&quot;http://text-learn.qiniudn.com/92229A82923CC488CB77AD3C2F914195.JPG&quot; alt=&quot;img&quot; width=&quot;1004&quot; height=&quot;407&quot; /&gt;<!-- /react-text --><p data-reactid="83">我们一开始认为，那一定是IE浏览器的锅，于是用浏览器打开页面一看，表现也是有白边，加各种样式也去不掉，后来发现是代码间的换行导致的，于是很简单，我们随便弄个在线的html压缩工具把代码一压缩就行了，IE下的白边果然就没有了。</p><p data-reactid="84"><!-- react-text: 85 -->然后再看，发现链接有默认样式（白边存在时不出现，很神奇），一个很难看的蓝框框，这个也简单，把图片和链接的<!-- /react-text --><code data-reactid="86">border</code><!-- react-text: 87 -->和<!-- /react-text --><code data-reactid="88">outline</code><!-- react-text: 89 -->、<!-- /react-text --><code data-reactid="90">text-decoration</code><!-- react-text: 91 --> 统统设为none就行。<!-- /react-text --></p><p data-reactid="92"><!-- react-text: 93 -->但是茫茫多的图片和链接，都要到inline里面一个一个设置显然工作量很大，没关系，我们可以使用<!-- /react-text --><a href="https://github.com/Automattic/juice" data-reactid="94">juice</a><!-- react-text: 95 -->这个工具，可以很方便的帮我们把style放到inline里面去。写个gulp任务还是很容易的。<!-- /react-text --></p><p data-reactid="96">再看IE浏览器的效果，OK了，但是回头看windows outlook客户端，还是老样子，时间太晚，决定回家再说，家里装的最新的windows10自带的新式邮件客户端，估计高级货应该没问题，结果回去一看还是一样的问题。微软太令我失望了。不过新的客户端可以很容易的把邮件另存为eml格式，这样我用编辑器打开就可以查看源码了，于是我就去找别人写好的案例，自己写不行，抄还不会么？</p><p data-reactid="97"><!-- react-text: 98 -->发现人家有的是把链接和图片包在<!-- /react-text --><code data-reactid="99">&lt;p&gt;</code><!-- react-text: 100 -->标签里，没关系，可以用<!-- /react-text --><a href="https://github.com/cheeriojs/cheerio" data-reactid="101">cheerio</a><!-- react-text: 102 -->这个<!-- /react-text --><code data-reactid="103">node端的jQuey</code><!-- react-text: 104 -->库，找到文本里所有的<!-- /react-text --><code data-reactid="105">&lt;td&gt;</code><!-- react-text: 106 -->下的<!-- /react-text --><code data-reactid="107">&lt;img&gt;</code><!-- react-text: 108 -->或<!-- /react-text --><code data-reactid="109">&lt;a&gt;</code><!-- react-text: 110 -->，只需要用iQuery一样的wrap语法外面包一层就行：<!-- /react-text --></p><!-- react-text: 111 -->&lt;pre class=&quot;EnlighterJSRAW&quot; data-enlighter-language=&quot;js&quot;&gt;var cheerio = require(&#x27;cheerio&#x27;); var $ = cheerio.load(content); var p = $(&#x27;&lt;p style=&quot;margin:0; padding:0&quot;&gt;&lt;/p&gt;&#x27;) $(&#x27;td &gt; a&#x27;).wrap(p); $(&#x27;td &gt; img&#x27;).wrap(p);&lt;/pre&gt;<!-- /react-text --><p data-reactid="112">心里刚刚为自己的机智点赞，但是实验的效果依然跟之前一样。看来不是这个原因。</p><p data-reactid="113">最后只得一张图片一张图片的check，希望能通过归纳法找到规律，结果还真找到了，之前切图的同学有一些图片高度上切的比较窄，而outlook对应浏览器的渲染对tr有个内置的最小高度，当图片高度小于这个最小高度的话，白边就出现了，于是乎只能重新切图。</p><p data-reactid="114">切完图以后再retry，效果比之前好很多，但还是有细细的白边，于是继续另存以后check代码，发现我们之前因为safari浏览器可以很方便的直接将网页以邮件发送，都是用的这种形式进行发送，但是代码里显示，用这种方式发的话，它会在你的代码外面包一些额外的标签</p><!-- react-text: 115 -->&lt;pre class=&quot;EnlighterJSRAW&quot; data-enlighter-language=&quot;html&quot;&gt;&lt;base class=3D&quot;&quot;&gt; &lt;div class=3D&quot;Apple-Mail-URLShareUserContentTopClass&quot;&gt;&lt;br class=3D&quot;&quot;&gt; &lt;/div&gt; &lt;div class=3D&quot;Apple-Mail-URLShareWrapperClass&quot; style=3D&quot;position:relative!i= mportant&quot;&gt; &lt;blockquote type=3D&quot;cite&quot; class=3D&quot;&quot; style=3D&quot;border-left-style:none; color= :inherit; padding:inherit; margin:inherit&quot;&gt; &lt;br class=3D&quot;&quot;&gt;&lt;/pre&gt;<!-- /react-text --><p data-reactid="116"><!-- react-text: 117 -->外部包了这一堆都是源码中没有的，然后我尝试去掉了<!-- /react-text --><code data-reactid="118">&lt;blockquote&gt;</code><!-- react-text: 119 -->标签，效果就OK了，但是怎么把这个邮件发出去就是问题了。最后尝试了一下，发现可以先用safari发送给自己，收到以后再全选以后复制粘贴用邮件客户端发送，就不会有这些额外的标签了。<!-- /react-text --></p><h3 id="tips" data-reactid="120"><a href="#tips" aria-hidden="true" data-reactid="121"><span class="icon icon-link" data-reactid="122"></span></a><!-- react-text: 123 -->Tips<!-- /react-text --></h3><ul data-reactid="124"><li data-reactid="125">使用photoshop的切片工具可以无需编写代码就方便的生成页面</li><li data-reactid="126">切图时注意不要有高度值太小的，切片高度应大于40px为佳</li><li data-reactid="127">使用table布局和inline style</li><li data-reactid="128">需要对html代码进行压缩，规避IE下空格和换行符的影响</li><li data-reactid="129"><!-- react-text: 130 -->使用<!-- /react-text --><a href="https://github.com/Automattic/juice" data-reactid="131">juice</a><!-- react-text: 132 -->将style标签里的样式自动变成inline style<!-- /react-text --></li><li data-reactid="133">&lt;map&gt;标签在Mac邮件客户端里无法识别</li><li data-reactid="134"><!-- react-text: 135 -->对于链接和图片，需要设置<!-- /react-text --><code data-reactid="136">border</code><!-- react-text: 137 -->、<!-- /react-text --><code data-reactid="138">outline</code><!-- react-text: 139 -->、<!-- /react-text --><code data-reactid="140">text-decoration</code><!-- react-text: 141 --> 为none<!-- /react-text --></li><li data-reactid="142">邮件制作看似简单，要做好也需要一个构建环境，目前我用的是gulp+juice+htmlmin</li></ul></article><div data-reactid="143"></div><nav class="single-bar clearfix" data-reactid="144"><span class="prev" data-reactid="145"><a rel="prev" href="/blog/fe/riot-js-框架深入解析" data-reactid="146"><em class="eux-icon eux-icon-page-prev" data-reactid="147"></em><!-- react-text: 148 -->Riot.js 框架深入解析<!-- /react-text --></a></span><span class="next" data-reactid="149"><a rel="next" href="/blog/fe/前后端数据传输不得不面对的转码问题" data-reactid="150"><em class="eux-icon eux-icon-page-next" data-reactid="151"></em><!-- react-text: 152 -->前后端数据传输不得不面对的转码问题<!-- /react-text --></a></span></nav></div></div></div><footer class="footer" data-reactid="153"><div class="eux-footer-area-wrapper container-singular" role="complementary" data-reactid="154"><div class="inner clearfix" data-reactid="155"><aside id="simple-links-2" class="widget sl-links-main" data-reactid="156"><h2 class="widgettitle" data-reactid="157">友情链接</h2><ul class="simple-links-list simple-links-2-list" id="simple-links-2-list" data-reactid="158"><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="159"><a target="_blank" href="http://sux.baidu.com/" title="百度 FEX 团队" data-reactid="160">百度 FEX</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="161"><a target="_blank" href="http://efe.baidu.com/" title="百度 EFE 团队" data-reactid="162">百度 EFE</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="163"><a target="_blank" href="http://sux.baidu.com/" title="百度 SUX 团队" data-reactid="164">百度 SUX</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="165"><a target="_blank" href="https://aotu.io/" title="京东凹凸实验室，面向多终端技术体系，致力于构建沉淀与分享包括但不限于交互、页面制作技巧、前端开发、原生APP开发等方面的专业知识及案例。" data-reactid="166">凹凸实验室</a></li><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="167"><a target="_blank" href="https://fed.renren.com/" title="人人网FED" data-reactid="168">人人网FED</a></li></ul></aside></div></div><div class="eux-icp" data-reactid="169"><!-- react-text: 170 -->百度EUX 版权所有 ©百度EUX    All rights reserved. 骄傲地采用 <!-- /react-text --><a target="_blank" href="https://github.com/picidaejs/picidaejs" data-reactid="171">Picidae</a><!-- react-text: 172 -->。<!-- /react-text --></div></footer></div>
</div>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>